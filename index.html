



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.3">
    
    
      
        <title>pyfields</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#pyfields" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="." title="pyfields" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              pyfields
            </span>
            <span class="md-header-nav__topic">
              
                Home
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/smarie/python-pyfields/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="." title="pyfields" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    pyfields
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/smarie/python-pyfields/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Home
      </label>
    
    <a href="." title="Home" class="md-nav__link md-nav__link--active">
      Home
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing" class="md-nav__link">
    Installing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-defining-a-field" class="md-nav__link">
    1. Defining a field
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#field-vs-python-attribute" class="md-nav__link">
    Field vs. Python attribute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-validation" class="md-nav__link">
    Type validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#value-validation" class="md-nav__link">
    Value validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converters" class="md-nav__link">
    Converters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#native-vs-descriptor-fields" class="md-nav__link">
    Native vs. Descriptor fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-adding-a-constructor" class="md-nav__link">
    2. Adding a constructor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-make_init" class="md-nav__link">
    a - make_init
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-init_fields" class="md-nav__link">
    b - @init_fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-features-benefits" class="md-nav__link">
    Main features / benefits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    See Also
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    Others
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#want-to-contribute" class="md-nav__link">
    Want to contribute ?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="why/" title="Why fields" class="md-nav__link">
      Why fields
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="api_reference/" title="API reference" class="md-nav__link">
      API reference
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing" class="md-nav__link">
    Installing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-defining-a-field" class="md-nav__link">
    1. Defining a field
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#field-vs-python-attribute" class="md-nav__link">
    Field vs. Python attribute
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-validation" class="md-nav__link">
    Type validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#value-validation" class="md-nav__link">
    Value validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converters" class="md-nav__link">
    Converters
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#native-vs-descriptor-fields" class="md-nav__link">
    Native vs. Descriptor fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-adding-a-constructor" class="md-nav__link">
    2. Adding a constructor
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-make_init" class="md-nav__link">
    a - make_init
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-init_fields" class="md-nav__link">
    b - @init_fields
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-features-benefits" class="md-nav__link">
    Main features / benefits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    See Also
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    Others
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#want-to-contribute" class="md-nav__link">
    Want to contribute ?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/smarie/python-pyfields/edit/master/docs/index.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="pyfields">pyfields<a class="headerlink" href="#pyfields" title="Permanent link">&para;</a></h1>
<p><em>Define fields in python classes. Easily.</em></p>
<p><a href="https://pypi.python.org/pypi/pyfields/"><img alt="Python versions" src="https://img.shields.io/pypi/pyversions/pyfields.svg" /></a> <a href="https://travis-ci.org/smarie/python-pyfields"><img alt="Build Status" src="https://travis-ci.org/smarie/python-pyfields.svg?branch=master" /></a> <a href="https://smarie.github.io/python-pyfields/junit/report.html"><img alt="Tests Status" src="https://smarie.github.io/python-pyfields/junit/junit-badge.svg?dummy=8484744" /></a> <a href="https://codecov.io/gh/smarie/python-pyfields"><img alt="codecov" src="https://codecov.io/gh/smarie/python-pyfields/branch/master/graph/badge.svg" /></a></p>
<p><a href="https://smarie.github.io/python-pyfields/"><img alt="Documentation" src="https://img.shields.io/badge/doc-latest-blue.svg" /></a> <a href="https://pypi.python.org/pypi/pyfields/"><img alt="PyPI" src="https://img.shields.io/pypi/v/pyfields.svg" /></a> <a href="https://pepy.tech/project/pyfields"><img alt="Downloads" src="https://pepy.tech/badge/pyfields" /></a> <a href="https://pepy.tech/project/pyfields"><img alt="Downloads per week" src="https://pepy.tech/badge/pyfields/week" /></a> <a href="https://github.com/smarie/python-pyfields/stargazers"><img alt="GitHub stars" src="https://img.shields.io/github/stars/smarie/python-pyfields.svg" /></a></p>
<p><code>pyfields</code> provides a simple and elegant way to define fields in python classes. With <code>pyfields</code> you explicitly define all aspects of a field (default value, type, documentation...) in a single place, and can refer to it from other places.</p>
<p>It is designed with <strong>development freedom</strong> as primary target: </p>
<ul>
<li>
<p><em>code segregation</em>. Everything is in the field, not in <code>__init__</code>, not in <code>__setattr__</code>.</p>
</li>
<li>
<p><em>absolutely no constraints</em>. Your class does not need to use type hints. You can use python 2 and 3.5. Your class is not modified behind your back: <code>__init__</code> and <code>__setattr__</code> are untouched. You do not need to decorate your class. You do not need your class to inherit from anything. This is particularly convenient for mix-in classes, and in general for users wishing to stay in control of their class design.</p>
</li>
<li>
<p><em>no performance loss by default</em>. If you use <code>pyfields</code> to declare fields without adding validators nor converters, instance attributes will be replaced with a native python attribute on first access, preserving the same level of performance than what you are used to.</p>
</li>
</ul>
<p>It provides <strong>many optional features</strong> that will make your object-oriented developments easier:</p>
<ul>
<li>
<p>all field declarations support <em>type hints</em> and <em>docstring</em>,</p>
</li>
<li>
<p>optional fields can have <em>default values</em> but also <em>default values factories</em> (such as <em>"if no value is provided, copy this other field"</em>)</p>
</li>
<li>
<p>adding <em>validators</em> and <em>converters</em> to a field does not require you to write complex logic nor many lines of code. This makes field access obviously slower than the default native implementation but it is done field by field and not on the whole class at once, so fast native fields can coexist with slower validated ones (segregation principle).</p>
</li>
<li>
<p>initializing fields in your <em>constructor</em> is very easy and highly customizable</p>
</li>
</ul>
<p>If your first reaction is "what about <code>attrs</code> / <code>dataclasses</code> / <code>pydantic</code> / <code>characteristic</code> / <code>traits</code> / <code>traitlets</code> / <code>autoclass</code> / ...", please have a look <a href="why/">here</a>.</p>
<h2 id="installing">Installing<a class="headerlink" href="#installing" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span>&gt; pip install pyfields
</pre></div>


<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<h3 id="1-defining-a-field">1. Defining a field<a class="headerlink" href="#1-defining-a-field" title="Permanent link">&para;</a></h3>
<p>A field is defined as a class member using the <code>field()</code> method. The idea (not new) is that you declare in a single place all aspects related to each field. For mandatory fields you do not need to provide any argument. For optional fields, you will typically provide a <code>default</code> value or a <code>default_factory</code> (we will see that later).</p>
<p>For example let's create a <code>Wall</code> class with one <em>mandatory</em> <code>height</code> and one <em>optional</em> <code>color</code> field:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pyfields</span> <span class="kn">import</span> <span class="n">field</span>

<span class="k">class</span> <span class="nc">Wall</span><span class="p">:</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Height of the wall in mm.&quot;</span><span class="p">)</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Color of the wall.&quot;</span><span class="p">)</span>
</pre></div>


<div class="admonition info">
<p class="admonition-title">Compliance with python &lt; 3.6</p>
<p>If you use python &lt; <code>3.6</code> you know that PEP484 type hints can not be declared as shown above. However you can provide them as <a href="https://www.python.org/dev/peps/pep-0484/#type-comments">type comments</a>, or using the <code>type_hint</code> argument.</p>
</div>
<h4 id="field-vs-python-attribute">Field vs. Python attribute<a class="headerlink" href="#field-vs-python-attribute" title="Permanent link">&para;</a></h4>
<p>By default when you use <code>field()</code>, nothing more than a "lazy field" is created on your class. This field will only be activated when you access it on an instance. That means that you are free to implement <code>__init__</code> as you wish, or even to rely on the default <code>object</code> constructor to create instances:</p>
<div class="codehilite"><pre><span></span><span class="c1"># instantiate using the default `object` constructor</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">Wall</span><span class="p">()</span>
</pre></div>


<p>No exception here even if we did not provide any value for the mandatory field <code>height</code> ! Although this default behaviour can look surprising, you will find that this feature is quite handy to define mix-in classes <em>with</em> attributes but <em>without</em> constructor. See <a href="https://smarie.github.io/python-mixture/">mixture</a> for discussion. Of course if you do not like this behaviour you can very easily <a href="#2-adding-a-constructor">add a constructor</a>.</p>
<p>Until it is accessed for the first time, a field is visible on an instance with <code>dir()</code> (because its definition is inherited from the class) but not with <code>vars()</code> (because it has not been initialized on the object):</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">dir</span><span class="p">(</span><span class="n">w</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
<span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">vars</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="p">{}</span>
</pre></div>


<p>As soon as you access it, a field is replaced with a standard native python attribute, visible in <code>vars</code>:</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">color</span>  <span class="c1"># optional field: tdefault value is used</span>
<span class="s1">&#39;white&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">vars</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">}</span>
</pre></div>


<p>Of course mandatory fields must be initialized:</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">height</span>
<span class="n">pyfields</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">MandatoryFieldInitError</span><span class="p">:</span> \
   <span class="n">Mandatory</span> <span class="n">field</span> <span class="s1">&#39;height&#39;</span> <span class="n">has</span> <span class="ow">not</span> <span class="n">been</span> <span class="n">initialized</span> <span class="n">yet</span> <span class="n">on</span> <span class="n">instance</span> <span class="o">&lt;...&gt;.</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">12</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">vars</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
</pre></div>


<p>Your IDE (e.g. PyCharm) should recognize the name and type of the field, so you can already refer to it easily in other code using autocompletion:</p>
<p><img alt="pycharm_autocomplete1.png" src="imgs/autocomplete1.png" /></p>
<h4 id="type-validation">Type validation<a class="headerlink" href="#type-validation" title="Permanent link">&para;</a></h4>
<p>You can add type validation to a field by setting <code>check_type=True</code>.</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Wall</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">check_type</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Height of the wall in mm.&quot;</span><span class="p">)</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">check_type</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Color of the wall.&quot;</span><span class="p">)</span>
</pre></div>


<p>yields</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nv">w</span> <span class="o">=</span> <span class="nv">Wall</span><span class="ss">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nv">w</span>.<span class="nv">height</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nv">w</span>.<span class="nv">height</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">1</span><span class="s1">&#39;</span>
<span class="nv">TypeError</span>: <span class="nv">Invalid</span> <span class="nv">value</span> <span class="nv">type</span> <span class="nv">provided</span> <span class="k">for</span> <span class="s1">&#39;</span><span class="s">Wall.height</span><span class="s1">&#39;</span>. \ 
  <span class="nv">Value</span> <span class="nv">should</span> <span class="nv">be</span> <span class="nv">of</span> <span class="nv">type</span> <span class="s1">&#39;</span><span class="s">int</span><span class="s1">&#39;</span>. <span class="nv">Instead</span>, <span class="nv">received</span> <span class="nv">a</span> <span class="s1">&#39;</span><span class="s">str</span><span class="s1">&#39;</span>: <span class="s1">&#39;</span><span class="s">1</span><span class="s1">&#39;</span>
</pre></div>


<div class="admonition info">
<p class="admonition-title">Compliance with python &lt; 3.6</p>
<p>If you use python &lt; <code>3.6</code> and require type validation you should not use <a href="https://www.python.org/dev/peps/pep-0484/#type-comments">type comments</a> but rather use the <code>type_hint</code> argument in <code>field</code>. Indeed it is not possible for python code to access type comments without source code inspection.</p>
</div>
<h4 id="value-validation">Value validation<a class="headerlink" href="#value-validation" title="Permanent link">&para;</a></h4>
<p>You can add value (and type) validation to a field by providing <code>validators</code>. <code>pyfields</code> relies on <code>valid8</code> for validation, so the supported syntax is the same:</p>
<ul>
<li>
<p>For a single validator, either provide a <code>&lt;callable&gt;</code> or a tuple <code>(&lt;callable&gt;, &lt;error_msg&gt;)</code>, <code>(&lt;callable&gt;, &lt;failure_type&gt;)</code> or <code>(&lt;callable&gt;, &lt;error_msg&gt;, &lt;failure_type&gt;)</code>. See <a href="https://smarie.github.io/python-valid8/validation_funcs/c_simple_syntax/#1-one-validation-function">here</a> for details.</p>
</li>
<li>
<p>For several validators, either provide a list or a dictionary. See <a href="https://smarie.github.io/python-valid8/validation_funcs/c_simple_syntax/#2-several-validation-functions">here</a> for details.</p>
</li>
</ul>
<p>For example:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">mini_lambda</span> <span class="kn">import</span> <span class="n">x</span>
<span class="kn">from</span> <span class="nn">valid8.validation_lib</span> <span class="kn">import</span> <span class="n">is_in</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">}</span>

<span class="k">class</span> <span class="nc">Wall</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">validators</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;should be a positive number&#39;</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span>
                                    <span class="s1">&#39;should be a multiple of 100&#39;</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">},</span> 
                        <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Height of the wall in mm.&quot;</span><span class="p">)</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">validators</span><span class="o">=</span><span class="n">is_in</span><span class="p">(</span><span class="n">colors</span><span class="p">),</span> 
                       <span class="n">default</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> 
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Color of the wall.&quot;</span><span class="p">)</span>
</pre></div>


<p>yields</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nv">w</span> <span class="o">=</span> <span class="nv">Wall</span><span class="ss">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nv">w</span>.<span class="nv">height</span> <span class="o">=</span> <span class="mi">100</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nv">w</span>.<span class="nv">height</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nv">valid8</span>.<span class="nv">entry_points</span>.<span class="nv">ValidationError</span>[<span class="nv">ValueError</span>]: 
    <span class="nv">Error</span> <span class="nv">validating</span> [<span class="o">&lt;</span>...<span class="o">&gt;</span>.<span class="nv">Wall</span>.<span class="nv">height</span><span class="o">=</span><span class="mi">1</span>]. 
    <span class="nv">At</span> <span class="nv">least</span> <span class="nv">one</span> <span class="nv">validation</span> <span class="nv">function</span> <span class="nv">failed</span> <span class="k">for</span> <span class="nv">value</span> <span class="mi">1</span>. 
    <span class="nv">Successes</span>: [<span class="s1">&#39;</span><span class="s">x &gt; 0</span><span class="s1">&#39;</span>] <span class="o">/</span> <span class="nv">Failures</span>: {
      <span class="s1">&#39;</span><span class="s">x % 100 == 0</span><span class="s1">&#39;</span>: <span class="s1">&#39;</span><span class="s">InvalidValue: should be a multiple of 100. Returned False.</span><span class="s1">&#39;</span>
    }.
<span class="o">&gt;&gt;&gt;</span> <span class="nv">w</span>.<span class="nv">color</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">magenta</span><span class="s1">&#39;</span>
<span class="nv">valid8</span>.<span class="nv">entry_points</span>.<span class="nv">ValidationError</span>[<span class="nv">ValueError</span>]: 
    <span class="nv">Error</span> <span class="nv">validating</span> [<span class="o">&lt;</span>...<span class="o">&gt;</span>.<span class="nv">Wall</span>.<span class="nv">color</span><span class="o">=</span><span class="nv">magenta</span>]. 
    <span class="nv">NotInAllowedValues</span>: <span class="nv">x</span> <span class="nv">in</span> {<span class="s1">&#39;</span><span class="s">blue</span><span class="s1">&#39;</span>, <span class="s1">&#39;</span><span class="s">red</span><span class="s1">&#39;</span>, <span class="s1">&#39;</span><span class="s">white</span><span class="s1">&#39;</span>} <span class="nv">does</span> <span class="nv">not</span> <span class="nv">hold</span> 
    <span class="k">for</span> <span class="nv">x</span><span class="o">=</span><span class="nv">magenta</span>. <span class="nv">Wrong</span> <span class="nv">value</span>: <span class="s1">&#39;</span><span class="s">magenta</span><span class="s1">&#39;</span>.
</pre></div>


<p>See <code>valid8</code> documentation for details about the <a href="https://smarie.github.io/python-valid8/validation_funcs/c_simple_syntax/">syntax</a> and available <a href="https://smarie.github.io/python-valid8/validation_funcs/b_base_validation_lib/">validation lib</a>.</p>
<p><strong>todo</strong> In addition to the above syntax, <code>pyfields</code> support that you add validators to a field after creation, using the <code>@field.validator</code> decorator:</p>
<p>Finally, for advanced validation scenarios you might with your validation callables to receive a bit of context. <code>pyfields</code> supports that the callables accept one, two or three arguments for this (where <code>valid8</code> supports only 1): <code>f(val)</code>, <code>f(obj, val)</code>, and <code>f(obj, field, val)</code>.</p>
<p>For example we can define walls where the width is a multiple of the length:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">valid8</span> <span class="kn">import</span> <span class="n">ValidationFailure</span>

<span class="k">class</span> <span class="nc">InvalidWidth</span><span class="p">(</span><span class="n">ValidationFailure</span><span class="p">):</span>
    <span class="n">help_msg</span> <span class="o">=</span> <span class="s1">&#39;should be a multiple of the height ({height})&#39;</span>

<span class="k">def</span> <span class="nf">validate_width</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">width</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">height</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">InvalidWidth</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">obj</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Wall</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Height of the wall in mm.&quot;</span><span class="p">)</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">validators</span><span class="o">=</span><span class="n">validate_width</span><span class="p">,</span>
                       <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Width of the wall in mm.&quot;</span><span class="p">)</span>
</pre></div>


<h4 id="converters">Converters<a class="headerlink" href="#converters" title="Permanent link">&para;</a></h4>
<p><em>todo</em></p>
<h4 id="native-vs-descriptor-fields">Native vs. Descriptor fields<a class="headerlink" href="#native-vs-descriptor-fields" title="Permanent link">&para;</a></h4>
<p><code>field()</code> by default creates a so-called <strong>native field</strong>. This special construct is designed to be as fast as a normal python attribute after the first access, so that performance is not impacted. This high level of performance has a drawback: validation and conversion are not possible on a native field. </p>
<p>So when you add type or value validation, or conversion, to a field, <code>field()</code> will automatically create a <strong>descriptor field</strong> instead of a native field. This is an object relying on the <a href="https://docs.python.org/howto/descriptor.html">python descriptor protocol</a>. Such objects have slower access time than native python attributes but provide convenient hooks necessary to perform validation and conversion.</p>
<p>For experiments, you can force a field to be a descriptor by setting <code>native=False</code>:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pyfields</span> <span class="kn">import</span> <span class="n">field</span>

<span class="k">class</span> <span class="nc">Foo</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">field</span><span class="p">()</span>               <span class="c1"># a native field</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">native</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>   <span class="c1"># a descriptor field</span>
</pre></div>


<p>We can easily see the difference (note: direct class access <code>Foo.a</code> is currently forbidden because of <a href="https://github.com/smarie/python-pyfields/issues/12">this issue</a>):</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">Foo</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">NativeField</span><span class="p">:</span> <span class="o">&lt;...&gt;.</span><span class="n">Foo</span><span class="o">.</span><span class="n">a</span><span class="o">&gt;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">Foo</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">DescriptorField</span><span class="p">:</span> <span class="o">&lt;...&gt;.</span><span class="n">Foo</span><span class="o">.</span><span class="n">a</span><span class="o">&gt;</span>
</pre></div>


<p>And measure the difference in access time:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">timeit</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">set_a</span><span class="p">():</span> <span class="n">f</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">12</span>

<span class="k">def</span> <span class="nf">set_b</span><span class="p">():</span> <span class="n">f</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mi">12</span>

<span class="k">def</span> <span class="nf">set_c</span><span class="p">():</span> <span class="n">f</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="mi">12</span>

<span class="n">ta</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">set_a</span><span class="p">)</span><span class="o">.</span><span class="n">timeit</span><span class="p">()</span>
<span class="n">tb</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">set_b</span><span class="p">)</span><span class="o">.</span><span class="n">timeit</span><span class="p">()</span>
<span class="n">tc</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">set_c</span><span class="p">)</span><span class="o">.</span><span class="n">timeit</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Average time (ns) setting the field:&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2"> (normal python) ; </span><span class="si">%0.2f</span><span class="s2"> (native field) ;&quot;</span> 
      <span class="s2">&quot; </span><span class="si">%0.2f</span><span class="s2"> (descriptor field)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tc</span><span class="p">,</span> <span class="n">ta</span><span class="p">,</span> <span class="n">tb</span><span class="p">))</span>
</pre></div>


<p>yields (results depend on your machine):</p>
<div class="codehilite"><pre><span></span><span class="n">Average</span> <span class="n">time</span> <span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="n">setting</span> <span class="n">the</span> <span class="n">field</span><span class="p">:</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">09</span> <span class="p">(</span><span class="n">normal</span> <span class="n">python</span><span class="p">)</span> <span class="p">;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">09</span> <span class="p">(</span><span class="n">native</span> <span class="n">field</span><span class="p">)</span> <span class="p">;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">44</span> <span class="p">(</span><span class="k">descriptor</span> <span class="n">field</span><span class="p">)</span>
</pre></div>


<div class="admonition info">
<p class="admonition-title">Why are native fields so fast ?</p>
<p>Native fields are implemented as a <a href="https://docs.python.org/3.7/howto/descriptor.html">"non-data" python descriptor</a> that overrides itself on first access. So the first time the attribute is read, a small python method call extra cost is paid but the attribute is immediately replaced with a normal attribute inside the object <code>__dict__</code>. That way, subsequent calls use native python attribute access without overhead. This trick was inspired by <a href="https://tedboy.github.io/flask/generated/generated/werkzeug.cached_property.html">werkzeug's @cached_property</a>.</p>
</div>
<h3 id="2-adding-a-constructor">2. Adding a constructor<a class="headerlink" href="#2-adding-a-constructor" title="Permanent link">&para;</a></h3>
<p><code>pyfields</code> provides you with several alternatives to add a constructor to a class equipped with fields. The reason why we do not follow the <a href="https://www.python.org/dev/peps/pep-0020/#the-zen-of-python">Zen of python</a> here (<em>"There should be one-- and preferably only one --obvious way to do it."</em>) is to recognize that different developers may have different coding style or philosophies, and to be as much as possible agnostic in front of these.</p>
<h4 id="a-make_init">a - <code>make_init</code><a class="headerlink" href="#a-make_init" title="Permanent link">&para;</a></h4>
<p><code>make_init</code> is the <strong>most compact</strong> way to add a constructor to a class with fields. With it you create your <code>__init__</code> method in one line:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pyfields</span> <span class="kn">import</span> <span class="n">field</span><span class="p">,</span> <span class="n">make_init</span>

<span class="k">class</span> <span class="nc">Wall</span><span class="p">:</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Height of the wall in mm.&quot;</span><span class="p">)</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Color of the wall.&quot;</span><span class="p">)</span>
<span class="hll">    <span class="fm">__init__</span> <span class="o">=</span> <span class="n">make_init</span><span class="p">()</span>
</span></pre></div>


<p>By default, all fields will appear in the constructor, in the order of appearance in the class and its parents, following the <code>mro</code> (method resolution order, the order in which python looks for a method in the hierarchy of classes). Since it is not possible for mandatory fields to appear <em>after</em> optional fields in the signature, all mandatory fields will appear first, and then all optional fields will follow.</p>
<p>The easiest way to see the result is probably to look at the help on your class:</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="n">Wall</span><span class="p">)</span>
<span class="n">Help</span> <span class="k">on</span> <span class="k">class</span> <span class="n">Wall</span> <span class="k">in</span> <span class="n">module</span> <span class="o">&lt;</span><span class="p">...</span><span class="o">&gt;</span><span class="p">:</span>

<span class="k">class</span> <span class="n">Wall</span><span class="p">(</span><span class="n">builtins</span><span class="p">.</span><span class="k">object</span><span class="p">)</span>
<span class="hll"> <span class="o">|</span>  <span class="n">Wall</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</span> <span class="o">|</span>  <span class="p">(...)</span>
</pre></div>


<p>or you can inspect the method:</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nv">help</span><span class="ss">(</span><span class="nv">Wall</span>.<span class="nv">__init__</span><span class="ss">)</span>
<span class="nv">Help</span> <span class="nv">on</span> <span class="nv">function</span> <span class="nv">__init__</span> <span class="nv">in</span> <span class="nv">module</span> <span class="o">&lt;</span>...<span class="o">&gt;</span>:

<span class="hll"><span class="nv">__init__</span><span class="ss">(</span><span class="nv">self</span>, <span class="nv">height</span>, <span class="nv">color</span><span class="o">=</span><span class="s1">&#39;</span><span class="s">white</span><span class="s1">&#39;</span><span class="ss">)</span>
</span>    <span class="nv">The</span> `<span class="nv">__init__</span>` <span class="nv">method</span> <span class="nv">generated</span> <span class="k">for</span> <span class="nv">you</span> <span class="nv">when</span> <span class="nv">you</span> <span class="nv">use</span> `<span class="nv">make_init</span>`
</pre></div>


<p>You can check that your constructor works as expected:</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Wall</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">vars</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Wall</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">vars</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">Wall</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="fm">__init__</span><span class="p">()</span> <span class="n">missing</span> <span class="mi">1</span> <span class="n">required</span> <span class="n">positional</span> <span class="n">argument</span><span class="p">:</span> <span class="s1">&#39;height&#39;</span>
</pre></div>


<p>If you do not wish the generated constructor to expose all fields, you can customize it by providing an <strong>explicit</strong> ordered list of fields. For example below only <code>height</code> will be in the constructor:</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pyfields</span> <span class="kn">import</span> <span class="n">field</span><span class="p">,</span> <span class="n">make_init</span>

<span class="k">class</span> <span class="nc">Wall</span><span class="p">:</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Height of the wall in mm.&quot;</span><span class="p">)</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Color of the wall.&quot;</span><span class="p">)</span>

    <span class="c1"># only `height` will be in the constructor</span>
<span class="hll">    <span class="fm">__init__</span> <span class="o">=</span> <span class="n">make_init</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
</span></pre></div>


<p>The list can contain fields defined in another class, typically a parent class: </p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pyfields</span> <span class="kn">import</span> <span class="n">field</span><span class="p">,</span> <span class="n">make_init</span>

<span class="k">class</span> <span class="nc">Wall</span><span class="p">:</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Height of the wall in mm.&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ColoredWall</span><span class="p">(</span><span class="n">Wall</span><span class="p">):</span>
    <span class="n">color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Color of the wall.&quot;</span><span class="p">)</span>
    <span class="fm">__init__</span> <span class="o">=</span> <span class="n">make_init</span><span class="p">(</span><span class="n">Wall</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
</pre></div>


<p>Note: a pending <a href="https://github.com/smarie/python-pyfields/issues/12">issue</a> prevents the above example to work, you have to use <code>Wall.__dict__['height']</code> instead of <code>Wall.height</code> to reference the field from the other class.</p>
<p>Finally, you can customize the created constructor by declaring a post-init method as the <code>post_init_fun</code> argument. This is roughly equivalent to <code>@init_fields</code> so we do not present it here, see <a href="api_reference/#make_init">documentation</a>.</p>
<h4 id="b-init_fields">b - <code>@init_fields</code><a class="headerlink" href="#b-init_fields" title="Permanent link">&para;</a></h4>
<p>If you prefer to write an init function as usual, you can use the <code>@init_fields</code> decorator to augment this init function's signature with all or some fields.</p>
<div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pyfields</span> <span class="kn">import</span> <span class="n">field</span><span class="p">,</span> <span class="n">init_fields</span>

<span class="k">class</span> <span class="nc">Wall</span><span class="p">:</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Height of the wall in mm.&quot;</span><span class="p">)</span>  <span class="c1"># type: int</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;Color of the wall.&quot;</span><span class="p">)</span>  <span class="c1"># type: str</span>

<span class="hll">    <span class="nd">@init_fields</span>
</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor. After initialization, some print message is done</span>

<span class="sd">        :param msg: the message details to add</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;post init ! height=</span><span class="si">%s</span><span class="s2">, color=</span><span class="si">%s</span><span class="s2">, msg=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_field_attr</span> <span class="o">=</span> <span class="n">msg</span>
</pre></div>


<p>Note: as you can see in this example, you can of course create other attributes in this init function (done in the last line here with <code>self.non_field_attr = msg</code>). Indeed, declaring fields in a class do not "pollute" the class, so you can do anything you like as usual.</p>
<p>You can check that the resulting constructor works as expected:</p>
<div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="n">Wall</span><span class="p">)</span>
<span class="n">Help</span> <span class="k">on</span> <span class="k">class</span> <span class="n">Wall</span> <span class="k">in</span> <span class="n">module</span> <span class="o">&lt;</span><span class="p">...</span><span class="o">&gt;</span><span class="p">:</span>
<span class="k">class</span> <span class="n">Wall</span><span class="p">(</span><span class="n">builtins</span><span class="p">.</span><span class="k">object</span><span class="p">)</span>
 <span class="o">|</span>  <span class="n">Wall</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="p">...</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Wall</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hey&#39;</span><span class="p">)</span>
<span class="n">post</span> <span class="n">init</span> <span class="o">!</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">white</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">hey</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">vars</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="err">{</span><span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;non_field_attr&#39;</span><span class="p">:</span> <span class="s1">&#39;hey&#39;</span><span class="err">}</span>
</pre></div>


<p>Note on the order of arguments in the resulting <code>__init__</code> signature: as you can see, <code>msg</code> appears between <code>height</code> and <code>color</code> in the signature. This corresponds to the </p>
<h2 id="main-features-benefits">Main features / benefits<a class="headerlink" href="#main-features-benefits" title="Permanent link">&para;</a></h2>
<p><strong>TODO</strong></p>
<h2 id="see-also">See Also<a class="headerlink" href="#see-also" title="Permanent link">&para;</a></h2>
<p>This library was inspired by:</p>
<ul>
<li><a href="https://werkzeug.palletsprojects.com/en/0.15.x/utils/#werkzeug.utils.cached_property"><code>werkzeug.cached_property</code></a></li>
<li><a href="http://www.attrs.org/"><code>attrs</code></a></li>
<li><a href="https://docs.python.org/3/library/dataclasses.html"><code>dataclasses</code></a></li>
<li><a href="https://smarie.github.io/python-autoclass/"><code>autoclass</code></a></li>
<li><a href="https://pydantic-docs.helpmanual.io/"><code>pydantic</code></a></li>
</ul>
<h3 id="others">Others<a class="headerlink" href="#others" title="Permanent link">&para;</a></h3>
<p><em>Do you like this library ? You might also like <a href="https://github.com/smarie/OVERVIEW#python">my other python libraries</a></em> </p>
<h2 id="want-to-contribute">Want to contribute ?<a class="headerlink" href="#want-to-contribute" title="Permanent link">&para;</a></h2>
<p>Details on the github page: <a href="https://github.com/smarie/python-pyfields">https://github.com/smarie/python-pyfields</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
        
          <a href="why/" title="Why fields" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Why fields
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.ac79c3b0.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
    
  </body>
</html>